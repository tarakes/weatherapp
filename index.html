<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weatherapp-Tarakeswar</title>
    <link rel="icon" href="https://image.flaticon.com/icons/png/512/578/578116.png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="cssweb.css" type="text/css" rel="stylesheet">
    
</head>
<body>
    <p class="form">
        <span class="pl">
           city name <input type="text" id="ext" value="" placeholder="Enter cityname">
<button id="butt" onclick="printme()">submit</button> </span>
</p>
   <p id="webapp"></p>
  
    
   
   <script>
       function printme() {
           if(document.getElementById('ext').value != ""){
       document.getElementById('webapp').innerHTML='<div class="container"><img src="" alt="icon" id="image"><p id="weather"></p> <p id="temp">30 C</p><div class="details"><p id="place"></p><p id="day"></p><p id="time"></p></div></div>'
        var today = new Date();
        var day = ["sun", "mon", "tue", "wed", "thus", "fri", "sat"];
        document.getElementById('day').innerText = day[today.getDay()];
      //  document.getElementById('time').innerText = today.toTimeString();
        function formatAMPM(date) {
            var hours = date.getHours();
            var minutes = date.getMinutes();
            var ampm = hours >= 12 ? 'pm' : 'am';
            hours = hours % 12;
            hours = hours ? hours : 12; // the hour '0' should be '12'
            minutes = minutes < 10 ? '0' + minutes : minutes;
            var strTime = hours + ':' + minutes + ' ' + ampm;
            return strTime;
        }
        setInterval(function() {document.getElementById('time').innerText = formatAMPM(new Date());},100);
        // document.getElementById('time').innerText = formatAMPM(new Date());
       
        var linkval = "http://api.openweathermap.org/data/2.5/weather?q=" + document.getElementById('ext').value + "&appid=a2480db3f2ad21ebec714e386661942b";
        fetch(linkval)
        .then((response) => { return response.json() })
        .then((result) => { 
            document.getElementById('image').src= "http://openweathermap.org/img/wn/" +result.weather[0].icon + "@2x.png"  //.weather[0].icon;
            document.getElementById('weather').innerText=result.weather[0].main;
        document.getElementById('place').innerText=result.name;
    document.getElementById('temp').innerText=Math.round(result.main.temp - 273.15) + "Â°C"})
        .catch((err) => { console.log("could not fetch"); }); 
           }
       }
       
   </script>
</body>
</html>
